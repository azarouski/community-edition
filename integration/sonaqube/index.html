


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.2">
    
    
      
        <title>SonarQube Integration - Zebrunner</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a2408e81.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sonarqube-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Zebrunner" class="md-header-nav__button md-logo" aria-label="Zebrunner">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Zebrunner
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              SonarQube Integration
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/zebrunner/zebrunner/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Zebrunner" class="md-nav__button md-logo" aria-label="Zebrunner">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Zebrunner
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/zebrunner/zebrunner/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../install-guide/" title="Installation Guide" class="md-nav__link">
      Installation Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../config-guide/" title="Configuration Guide" class="md-nav__link">
      Configuration Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../user-guide/" title="User Guide" class="md-nav__link">
      User Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Integration
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Integration" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../scm/" title="Source Code Manager" class="md-nav__link">
      Source Code Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sonarqube.md" title="SonarQube" class="md-nav__link">
      SonarQube
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#integrate-private-sonarqube-server" class="md-nav__link">
    Integrate private sonarqube server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-configuration" class="md-nav__link">
    GitHub configuration
  </a>
  
    <nav class="md-nav" aria-label="GitHub configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-github-app" class="md-nav__link">
    Create a GitHub App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-your-app" class="md-nav__link">
    Install your app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-sonarqube-with-your-app" class="md-nav__link">
    Configure sonarqube with your app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pull-request-decoration-example" class="md-nav__link">
    Pull Request decoration example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitlab-configuration" class="md-nav__link">
    Gitlab configuration
  </a>
  
    <nav class="md-nav" aria-label="Gitlab configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merge-request-decoration-exmaple" class="md-nav__link">
    Merge request decoration exmaple
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-sonarqube-base-url" class="md-nav__link">
    Configure sonarqube base URL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support-channel" class="md-nav__link">
    Support Channel
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/zebrunner/zebrunner/edit/master/docs/integration/sonaqube.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="sonarqube-integration">SonarQube Integration</h1>
<p>The sonarqube static analysis is invoked for each webhook event triggered on your target repository(pushes and/or pull/merge requests).</p>
<p>If the event is a pull/merge request the reports from the sonarqube analysis will be decorated into the pull request itself for the correspondant scm system. On the contrary, only the analysis will run for push events.</p>
<blockquote>
<p>Note: default credentials for embedded sonarqube are: admin/admin, we recommend to change them after setting up zebrunner</p>
<p>Note: Sonarqube pull request decoration is supported for <strong>Github</strong> and <strong>Gitlab</strong></p>
<p>Note: if the sonarqube server is not available the analysis will be skipped</p>
</blockquote>
<h2 id="integrate-private-sonarqube-server">Integrate private sonarqube server</h2>
<p>If you have a private sonarqube instance and you have decided to use it, please follow the steps bellow:</p>
<ul>
<li>Login to Jenkins, go to <strong>Manage Jenkins &gt; System Configuration &gt; Global Properties</strong></li>
<li>Search for <strong>SONAR_URL</strong> and change the value with your private SonarQube instance url<blockquote>
<p>Note: Compatible SonarQube version is 7.9.3 - 8.0</p>
</blockquote>
</li>
</ul>
<h2 id="github-configuration">GitHub configuration</h2>
<p>To enable <strong>pull reqeuest decoration</strong> on your github repository you need to create a <strong>GitHub App</strong>, his purpose is to publish the sonarqube reports generated on the webhook event being processed as <strong>checks</strong> into the pull request itself on github. </p>
<h3 id="create-a-github-app">Create a <a href="https://developer.github.com/apps/about-apps/">GitHub App</a></h3>
<ul>
<li>Follow Steps 1–4 <a href="https://developer.github.com/apps/building-github-apps/creating-a-github-app/">here</a> to start creating your GitHub App</li>
<li>Under <strong>GitHub App name</strong>, give your app a name, such as SonarQubePRDecorator.</li>
<li>Add a <strong>Homepage URL</strong>. GitHub requires this, but it isn't important for Pull Request decoration. You can use any URL, such as https://zebrunner.com/.</li>
<li>Enter your <strong>User authorization callback URL</strong>. Set this to your instance's base URL. For example, <code>https://your-zebrunner-domain/sonarqube/oauth2/callback</code></li>
<li>Add <strong>Webhook URL</strong>. Set this to your instance's base URL. For example, https://zebrunner.com/.</li>
<li>
<p>Grant access for the following <strong>Permissions</strong>:</p>
<table>
<thead>
<tr>
<th align="center">Permission</th>
<th>Access</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Checks</td>
<td>Read &amp; Write</td>
</tr>
<tr>
<td align="center">Metadata</td>
<td>Read-Only</td>
</tr>
<tr>
<td align="center">Pull Requests</td>
<td>Read &amp; Write</td>
</tr>
<tr>
<td align="center">Commit statuses</td>
<td>Read-only</td>
</tr>
<tr>
<td align="center">&gt; Note: if your are using <strong>Github Enterprise</strong> the permission "Metadata" is renamed to "Repository Metadata"</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Under "Where can this GitHub App be installed?" select <strong>Any account.</strong></p>
</li>
<li>Click <strong>Create GitHub App</strong>. This will take you to your new GitHub App's page.</li>
<li>Scroll down to the bottom of your app page and click <strong>Generate Private Key.</strong> This downloads a .pem file that you'll use in the <strong>Configure SonarQube server section.</strong><blockquote>
<p>Tip: in order to acces the private key open the .pem file with your favorite text editor.</p>
</blockquote>
</li>
</ul>
<h3 id="install-your-app">Install your app</h3>
<p>Once the app is created, you need to install it in your target organization to <strong>grant acces</strong> to all of your repositories with the permissions specified in the <strong>Create a [GitHub App]</strong> section.</p>
<p>Install your GitHub App from the app's settings page.</p>
<ul>
<li>Go to your <strong>GitHub profile &gt; Developer settings &gt; GitHub Apps &gt; Your app name &gt; Install App</strong></li>
<li>Select the organization to install the app</li>
<li>Select <strong>All repositories</strong></li>
<li>Click install<blockquote>
<p>Note: You can select specific repositories, so the github application will have access <strong>only for those specified</strong></p>
</blockquote>
</li>
</ul>
<h3 id="configure-sonarqube-with-your-app">Configure sonarqube with your app</h3>
<ul>
<li>Login into your sonarqube instance</li>
<li>
<p>Go to <strong>Administration &gt; Configuration &gt; GitHub</strong> add your GitHub App <strong>Client ID, Client Secret</strong>
  <img alt="Alt text" src="https://github.com/qaprosoft/qps-infra/blob/develop/docs/img/SonarGitHubConfig.png?raw=true" title="SonarGitHubConfig" /></p>
</li>
<li>
<p>In <strong>Administration &gt; Configuration &gt; Pull Request</strong> add your GitHub <strong>App ID, App Name, App Private Key</strong>
  <img alt="Alt text" src="https://github.com/qaprosoft/qps-infra/blob/develop/docs/img/SonarPullRequestConfig.png?raw=true" title="SonarPullRequestConfig" /></p>
</li>
</ul>
<blockquote>
<p>Note: make sure to copy all content from the .pem file generated in the <strong>Create GitHub App</strong> section</p>
</blockquote>
<h3 id="pull-request-decoration-example">Pull Request decoration example</h3>
<p>When you create a pull and the sonar analysis reported issues, your pull request will be decorated with those issues and links to the sonarqube instance with your project.</p>
<p><img alt="Alt text" src="https://github.com/zebrunner/zebrunner/blob/master/docs/img/github-pr-deco1.png?raw=true" title="github-pr-deco1" />
<img alt="Alt text" src="https://github.com/zebrunner/zebrunner/blob/master/docs/img/github-pr-deco2.png?raw=true" title="github-pr-deco2" /></p>
<h2 id="gitlab-configuration">Gitlab configuration</h2>
<p>To enable <strong>merge requests decoration</strong> on your gitlab repository we are going to use the token generated in <strong>Gitlab access token</strong> step. The sonarqube report is published as pipeline status and comments into the merge request itself.</p>
<ul>
<li>Login into your sonarqube instance</li>
<li>Go to <strong>Administration &gt; Configuration &gt; Pull Requests &gt; Integration with Gitlab</strong> and in the token input paste your gitlab acces token.</li>
</ul>
<h3 id="merge-request-decoration-exmaple">Merge request decoration exmaple</h3>
<p>When you create a merge request and the sonar analysis reports issues, your merge request will be decorated with those issues and links to the sonarqube instance with your project.</p>
<p><img alt="Alt text" src="https://github.com/zebrunner/zebrunner/blob/master/docs/img/gitlab-mr-deco1.png?raw=true" title="gitlab-mr-deco1" />
<img alt="Alt text" src="https://github.com/zebrunner/zebrunner/blob/master/docs/img/gitlab-mr-deco2.png?raw=true" title="gitlab-mr-deco2" /></p>
<h2 id="configure-sonarqube-base-url">Configure sonarqube base URL</h2>
<p>This will serve static context(such as images, links, etc.) for pull/merge requests decoration. Follow the below steps to configure your server base URL:</p>
<ul>
<li>Add your SonarQube server under <strong>Administration &gt; Configuration &gt; General Settings &gt; Server base URL</strong>
  <img alt="Alt text" src="https://github.com/qaprosoft/qps-infra/blob/develop/docs/img/SonarBaseUrlConfig.png?raw=true" title="SonarBaseUrlConfig" /><blockquote>
<p>Tip: If you are missing images in your decorated pull/merge request it is probably due to configuration issues or the sonarqube server being unavailable at that moment.</p>
</blockquote>
</li>
</ul>
<h2 id="support-channel">Support Channel</h2>
<ul>
<li>Join <a href="https://t.me/zebrunner">Telegram channel</a> in case of any question</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>